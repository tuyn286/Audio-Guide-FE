import{_ as D,c,a as t,d as p,g as w,r as k,t as o,l as S,i as h,F as u,k as _,b as A,h as y,o as l,n as x}from"./index-C2DzRLYs.js";const T={name:"DetailSiteView",data(){return{site:{},maKhuDuLich:this.$route.params.maKhuDuLich,reviews:[],page:0,totalPages:0,showAllReviews:!1}},computed:{displayedReviews(){return this.showAllReviews?this.reviews:this.reviews.slice(0,5)},introHinhAnh(){var s;return((s=this.site.hinhAnhList)==null?void 0:s.filter(e=>e.loaiAnh==="INTRO"))||[]},bgHinhAnh(){var s;return((s=this.site.hinhAnhList)==null?void 0:s.find(e=>e.loaiAnh==="BG"))||null},avgDiemSo(){return this.reviews.length===0?0:(this.reviews.reduce((e,r)=>e+r.diemSo,0)/this.reviews.length).toFixed(1)},detailStar(){var r;const s=((r=this.reviews)==null?void 0:r.length)||0,e={fiveStar:0,fourStar:0,threeStar:0,twoStar:0,oneStar:0};return this.reviews.forEach(d=>{switch(d.diemSo){case 5:e.fiveStar++;break;case 4:e.fourStar++;break;case 3:e.threeStar++;break;case 2:e.twoStar++;break;case 1:e.oneStar++;break}}),{...e,total:s,percent:{fiveStar:s?e.fiveStar/s*100:0,fourStar:s?e.fourStar/s*100:0,threeStar:s?e.threeStar/s*100:0,twoStar:s?e.twoStar/s*100:0,oneStar:s?e.oneStar/s*100:0}}}},methods:{formatTimeAgo(s){const e=new Date,r=new Date(s),d=e-r,i=Math.floor(d/(1e3*60*60)),n=Math.floor(d/(1e3*60*60*24));return n===0?i===0?"Vừa xong":`${i} giờ trước`:n===1?"1 ngày trước":`${n} ngày trước`},async getSite(){try{const s=await y.get(`/khu-du-lich/${this.maKhuDuLich}`);this.site=s.data,console.log(this.site)}catch(s){console.error("Error fetching site:",s)}},async getReviews(){try{const e=(await y.get(`/danh-gia/${this.maKhuDuLich}`)).data||[];this.reviews=e.map(r=>({...r,ngayTao:this.formatTimeAgo(r.ngayTao)}))}catch(s){console.error("Error fetching reviews:",s)}}},mounted(){this.getSite(),this.getReviews()}},L={class:"container"},R={style:{"--bs-breadcrumb-divider":"'>'"},"aria-label":"breadcrumb",class:"ps-1 pt-1"},K={class:"breadcrumb"},H={class:"breadcrumb-item"},C={class:"breadcrumb-item"},N={class:"breadcrumb-item active","aria-current":"page"},V={class:"row p-5"},B={class:"col-lg-12 mb-0 align-items-center"},E={class:"h1 text-light text-center"},F={class:"row mt-2"},I={class:"col-12 border-bottom border-3 border-success p-0"},M={class:"h5 fw-bold text-start p-0 ps-2"},z={class:"text-muted mb-0"},G={class:"text-muted mb-0"},$={class:"text-muted mb-0"},j={class:"row mt-2"},O={class:"col-12 border-bottom border-3 border-success p-0"},P={class:"h5 fw-bold text-start p-0 ps-2"},X={class:"card box-shadow"},q=["src","alt"],J={class:"card-body"},Q={class:"card-text text-center fst-italic"},U={class:"row comment-box mb-5"},W={class:"col-12 border-bottom border-3 border-success p-0"},Y={class:"h5 fw-bold text-start p-0 ps-2"},Z={class:"col-lg-4 col-sm-12"},tt={class:"review-result fs-2 fw-bold mb-0 mt-3"},st={class:"text-warning mb-2 mx-auto"},et={class:"text-muted"},ot={class:"rating-bar justify-content-center"},at={class:"text-left"},it={class:"rating-label fw-bold pe-2"},rt={class:"rating-bar"},nt={class:"bar-container"},ct={class:"text-right pt-0 ps-1"},lt={class:"col-lg-8 col-sm-12"},dt={class:"row"},ht={class:"row mt-2"},ut={class:"col-8 align-self-center"},_t={class:"h6 m-0"},mt={class:"col-4"},bt={class:"card mx-auto"},ft={class:"card-body px-3 pt-2 pb-1"},gt={class:"card-text fst-italic mb-1"},vt={class:"text-warning mb-0"},pt={class:"card-title mb-0 fs-6"},wt={class:"text-muted"};function St(s,e,r,d,i,n){var f,g,v;const b=k("router-link");return l(),c("main",null,[t("div",L,[t("nav",R,[t("ol",K,[t("li",H,[p(b,{to:{name:"trang-chu"}},{default:w(()=>[h(o(s.$t("nav-1")),1)]),_:1})]),t("li",C,[p(b,{to:{name:"khu-du-lich"}},{default:w(()=>[h(o(s.$t("nav-2")),1)]),_:1})]),t("li",N,o(s.$t("detail-btn")),1)])]),t("div",{class:"introduce-section p-5",style:S({backgroundImage:(f=this.bgHinhAnh)!=null&&f.duongDan?`url(${this.bgHinhAnh.duongDan})`:"none"})},[t("div",V,[t("div",B,[t("h1",E,[t("b",null,o(i.site.tenKhuDuLich),1)])])])],4),t("div",F,[t("div",I,[t("h1",M,o(s.$t("info")),1)]),t("p",z,[e[1]||(e[1]=t("i",{class:"fa-solid fa-location-dot pe-2"},null,-1)),h(o(i.site.diaChi),1)]),t("p",G,[e[2]||(e[2]=t("i",{class:"fa-solid fa-phone pe-2"},null,-1)),h(o((g=i.site.taiKhoan)==null?void 0:g.soDienThoai),1)]),t("p",$,[e[3]||(e[3]=t("i",{class:"fa-solid fa-envelope pe-2"},null,-1)),h(o((v=i.site.taiKhoan)==null?void 0:v.email),1)])]),t("div",j,[t("div",O,[t("h1",P,o(s.$t("introduce")),1)]),t("p",null,o(i.site.moTa),1),(l(!0),c(u,null,_(n.introHinhAnh,a=>(l(),c("div",{class:"col-lg-10 col-sm-12 mx-auto",key:a.maHinhAnh},[t("div",X,[t("img",{src:a.duongDan,class:"card-img-top img-cover",alt:a.ngayTaiLen},null,8,q),t("div",J,[t("p",Q,o(a.moTa),1)])])]))),128))]),t("div",U,[t("div",W,[t("h1",Y,o(s.$t("rating")),1)]),t("div",Z,[t("p",tt,o(n.avgDiemSo),1),t("div",st,[(l(),c(u,null,_(5,a=>t("i",{key:a,class:x(a<=n.avgDiemSo?"fa-solid fa-star":"fa-regular fa-star")},null,2)),64))]),t("p",et,"Từ "+o(i.reviews.length)+" đánh giá",1),t("div",ot,[t("table",at,[(l(),c(u,null,_(["five","four","three","two","one"],(a,m)=>t("tr",{key:a},[t("td",it,o(5-m),1),t("td",rt,[t("div",nt,[t("div",{class:"bar-5 bar",style:S({width:n.detailStar.percent[""+a+"Star"]+"%"})},null,4)])]),t("td",ct,o(n.detailStar[a+"Star"]),1)])),64))])])]),t("div",lt,[t("div",dt,[t("div",ht,[t("div",ut,[t("h2",_t,o(s.$t("comment")),1)]),t("div",mt,[i.reviews.length>5?(l(),c("button",{key:0,class:"border-0 float-end bg-white text-success",onClick:e[0]||(e[0]=a=>i.showAllReviews=!i.showAllReviews)},o(i.showAllReviews?"Thu gọn":"Xem thêm"),1)):A("",!0)])]),(l(!0),c(u,null,_(n.displayedReviews,a=>(l(),c("div",{class:"col-12 border-bottom",key:a.maDanhGia},[t("div",bt,[t("div",ft,[t("p",gt,' "'+o(a.binhLuan)+'" ',1),t("div",vt,[(l(),c(u,null,_(5,m=>t("i",{key:m,class:x(m<=a.diemSo?"fa-solid fa-star":"fa-regular fa-star")},null,2)),64))]),t("h5",pt,o(a.taiKhoan.tenTaiKhoan||"Người dùng ẩn danh"),1),t("small",wt,o(a.ngayTao),1)])])]))),128))])])])])])}const xt=D(T,[["render",St],["__scopeId","data-v-f6c026fb"]]);export{xt as default};
