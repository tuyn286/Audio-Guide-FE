import{A as y}from"./AdminSideBar-CFQq7O3-.js";import{_ as T,c as r,a as t,d as g,g as D,r as h,b as p,F as w,k as x,n as u,t as l,h as m,p as C,o as d,i as V,w as _}from"./index-C2DzRLYs.js";const P={components:{AdminSideBar:y},data(){return{page:0,totalPages:0,tickets:[],selectedDate:C(null)}},methods:{async getTicket(){try{const n=await m.get("/ve/",{params:{page:this.page}});this.tickets=n.data.content.map(e=>({...e,ngayTao:this.formatTimeAgo(e.ngayTao)})),this.totalPages=n.data.page.totalPages}catch(n){console.error("Error fetching tickets:",n)}},onDateChange(n){this.selectedDate=n;try{m.get("/ve/",{params:{page:this.page,date:this.selectedDate}}).then(e=>{this.tickets=e.data.content.map(i=>({...i,ngayTao:this.formatTimeAgo(i.ngayTao)})),this.totalPages=e.data.page.totalPages})}catch(e){console.error("Error fetching tickets:",e)}},prePage(){this.page--,this.getTicket()},nextPage(){this.page++,this.getTicket()},editTicket(n){this.$router.push({name:"admin-edit-ticket",params:{maVe:n}})},deleteTicket(n){confirm("Bạn có chắc chắn muốn xóa vé này không?")&&m.delete(`/ve/${n}`).then(()=>{this.getTicket()})},formatTimeAgo(n){const e=new Date,i=new Date(n),c=e-i,o=Math.floor(c/(1e3*60*60)),s=Math.floor(c/(1e3*60*60*24));return s===0?o===0?"Vừa xong":`${o} giờ trước`:s<7?s===1?"1 ngày trước":`${s} ngày trước`:i.toLocaleDateString("vi-VN")}},created(){this.getTicket()}},M={class:"container mt-2 mb-5"},S={style:{"--bs-breadcrumb-divider":"'>'"},"aria-label":"breadcrumb",class:"ps-1 pt-1"},Y={class:"breadcrumb"},A={class:"breadcrumb-item"},B={class:"row mt-3"},L={class:"col-3 border-end"},N={class:"col-9"},E={class:"row"},K={class:"col-6"},F={class:"row"},j={class:"table align-middle mb-0 bg-white"},q=["onClick"],z=["onClick"],H={key:0,class:"text-danger p-4"},Q={class:"row"},U={class:"row d-flex justify-content-end align-items-end mt-5"},X={class:"col-4"},G={"aria-label":"Page navigation example"},I={class:"pagination float-end"},J={class:"page-item"},O={class:"page-link",href:"#"};function R(n,e,i,c,o,s){const b=h("router-link"),f=h("AdminSideBar"),v=h("el-date-picker");return d(),r("main",null,[t("div",M,[t("nav",S,[t("ol",Y,[t("li",A,[g(b,{to:{name:"admin"}},{default:D(()=>e[3]||(e[3]=[V("Quản lý")])),_:1})]),e[4]||(e[4]=t("li",{class:"breadcrumb-item active","aria-current":"page"},"Vé thuyết minh",-1))])]),t("div",B,[t("div",L,[g(f)]),t("div",N,[t("div",E,[e[5]||(e[5]=t("div",{class:"col-6"},null,-1)),t("div",K,[g(v,{style:{width:"100%"},modelValue:o.selectedDate,"onUpdate:modelValue":e[0]||(e[0]=a=>o.selectedDate=a),type:"date",placeholder:"Chọn ngày",format:"YYYY-MM-DD","value-format":"YYYY-MM-DD",onChange:s.onDateChange},null,8,["modelValue","onChange"])])]),t("div",F,[t("table",j,[e[6]||(e[6]=t("thead",{class:"bg-light"},[t("tr",null,[t("th",null,"Mã vé"),t("th",null,"Khu du lịch"),t("th",null,"Số lượng"),t("th",null,"Tổng tiền"),t("th",null,"Ngày tạo"),t("th",null,"Trạng thái"),t("th"),t("th")])],-1)),t("tbody",null,[(d(!0),r(w,null,x(o.tickets,a=>(d(),r("tr",{key:a.maVe},[t("td",null,l(a.maVe),1),t("td",null,l(a.khuDuLich.tenKhuDuLich),1),t("td",null,l(a.soLuong),1),t("td",null,l(a.giaVe*a.soLuong+"đ"),1),t("td",null,l(a.ngayTao),1),t("td",{class:u({"text-success":a.trangThai=="1"})},l(a.trangThai=="0"?"Đã xóa":"Đã thanh toán"),3),t("td",null,[t("button",{type:"button",class:"btn btn-warning btn-sm btn-rounded",onClick:_(k=>s.editTicket(a.maVe),["prevent"])}," Sửa ",8,q)]),t("td",null,[a.trangThai=="1"?(d(),r("button",{key:0,type:"button",class:"btn btn-danger btn-sm btn-rounded",onClick:_(k=>s.deleteTicket(a.maVe),["prevent"])}," Xóa ",8,z)):p("",!0)])]))),128))])]),this.tickets.length===0?(d(),r("h4",H,"Không tìm thấy kết quả!")):p("",!0)]),t("div",Q,[t("div",U,[t("div",X,[t("nav",G,[t("ul",I,[t("li",{class:u(["page-item",{disabled:o.page==0}])},[t("button",{onClick:e[1]||(e[1]=(...a)=>s.prePage&&s.prePage(...a)),class:"page-link"},"Trước")],2),t("li",J,[t("a",O,l(o.page+1),1)]),t("li",{class:u(["page-item",{disabled:o.page>=o.totalPages-1}])},[t("button",{onClick:e[2]||(e[2]=(...a)=>s.nextPage&&s.nextPage(...a)),class:"page-link"},"Sau")],2)])])])])])])])])])}const $=T(P,[["render",R]]);export{$ as default};
