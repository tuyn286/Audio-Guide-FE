import{M as k}from"./ManagerSideBar-eQhEIkbG.js";import{_ as y,c,a as e,d,g as T,r as g,F as D,k as w,n as h,t as i,h as m,p as V,o as u,i as C,w as p}from"./index-C2DzRLYs.js";const P={components:{ManagerSideBar:k},data(){return{page:0,totalPages:0,tickets:[],selectedDate:V(null)}},methods:{formatTimeAgo(n){const t=new Date,l=new Date(n),r=t-l,o=Math.floor(r/(1e3*60*60)),s=Math.floor(r/(1e3*60*60*24));return s===0?o===0?"Vừa xong":`${o} giờ trước`:s<7?s===1?"1 ngày trước":`${s} ngày trước`:l.toLocaleDateString("vi-VN")},async getTicket(){try{const n=await m.get("/ve/",{params:{page:this.page}});this.tickets=n.data.content.map(t=>({...t,ngayTao:this.formatTimeAgo(t.ngayTao)})),this.totalPages=n.data.page.totalPages}catch(n){console.error("Error fetching tickets:",n)}},onDateChange(n){this.selectedDate=n;try{m.get("/ve/",{params:{page:this.page,date:this.selectedDate}}).then(t=>{this.tickets=t.data.content.map(l=>({...l,ngayTao:this.formatTimeAgo(l.ngayTao)})),this.totalPages=t.data.page.totalPages})}catch(t){console.error("Error fetching tickets:",t)}},prePage(){this.page--,this.getTicket()},nextPage(){this.getTicket()},editTicket(n){this.$router.push({name:"manager-edit-ticket",params:{maVe:n}})},deleteTicket(n){confirm("Bạn có chắc chắn muốn xóa vé này không?")&&m.delete(`/ve/${n}`).then(()=>{this.getTicket()})}},created(){this.getTicket()}},x={class:"container mt-2 mb-5"},M={style:{"--bs-breadcrumb-divider":"'>'"},"aria-label":"breadcrumb",class:"ps-1 pt-1"},S={class:"breadcrumb"},Y={class:"breadcrumb-item"},B={class:"row mt-3"},N={class:"col-3 border-end"},L={class:"col-9"},A={class:"row"},E={class:"col-6"},F={class:"row"},j={class:"table align-middle mb-0 bg-white"},z=["onClick"],H=["onClick"],Q={class:"row"},U={class:"row d-flex justify-content-end align-items-end mt-5"},X={class:"col-4"},q={"aria-label":"Page navigation example"},G={class:"pagination float-end"},I={class:"page-item"},J={class:"page-link",href:"#"};function K(n,t,l,r,o,s){const _=g("router-link"),b=g("ManagerSideBar"),f=g("el-date-picker");return u(),c("main",null,[e("div",x,[e("nav",M,[e("ol",S,[e("li",Y,[d(_,{to:{name:"manager"}},{default:T(()=>t[3]||(t[3]=[C("Quản lý")])),_:1})]),t[4]||(t[4]=e("li",{class:"breadcrumb-item active","aria-current":"page"},"Vé thuyết minh",-1))])]),e("div",B,[e("div",N,[d(b)]),e("div",L,[e("div",A,[t[5]||(t[5]=e("div",{class:"col-6"},null,-1)),e("div",E,[d(f,{style:{width:"100%"},modelValue:o.selectedDate,"onUpdate:modelValue":t[0]||(t[0]=a=>o.selectedDate=a),type:"date",placeholder:"Chọn ngày",format:"YYYY-MM-DD","value-format":"YYYY-MM-DD",onChange:s.onDateChange},null,8,["modelValue","onChange"])])]),e("div",F,[e("table",j,[t[6]||(t[6]=e("thead",{class:"bg-light"},[e("tr",null,[e("th"),e("th",null,"Số lượng"),e("th",null,"Tổng tiền"),e("th",null,"Ngày tạo"),e("th"),e("th")])],-1)),e("tbody",null,[(u(!0),c(D,null,w(o.tickets,a=>(u(),c("tr",{key:a.maVe},[e("td",null,i(a.maVe),1),e("td",null,i(a.soLuong),1),e("td",null,i((a.soLuong*a.giaVe).toLocaleString("vn-VN")+"đ"),1),e("td",null,i(a.ngayTao),1),e("td",null,[e("button",{type:"button",class:"btn btn-warning btn-sm btn-rounded",onClick:p(v=>s.editTicket(a.maVe),["prevent"])}," Sửa ",8,z)]),e("td",null,[e("button",{type:"button",class:"btn btn-danger btn-sm btn-rounded",onClick:p(v=>s.deleteTicket(a.maVe),["prevent"])}," Xóa ",8,H)])]))),128))])])]),e("div",Q,[e("div",U,[e("div",X,[e("nav",q,[e("ul",G,[e("li",{class:h(["page-item",{disabled:o.page==0}])},[e("button",{onClick:t[1]||(t[1]=(...a)=>s.prePage&&s.prePage(...a)),class:"page-link"},"Trước")],2),e("li",I,[e("a",J,i(o.page+1),1)]),e("li",{class:h(["page-item",{disabled:o.page>=o.totalPages-1}])},[e("button",{onClick:t[2]||(t[2]=(...a)=>s.nextPage&&s.nextPage(...a)),class:"page-link"},"Sau")],2)])])])])])])])])])}const W=y(P,[["render",K]]);export{W as default};
